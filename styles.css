*{box-sizing:border-box}body{font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:#0e0f12;color:#eee}header{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:#1a1d23;border-bottom:1px solid #2b2f37}h1{font-size:20px;margin:0}.top-actions{display:flex;gap:12px;align-items:center}button{background:#3a6df0;color:#fff;border:none;border-radius:6px;padding:8px 12px;cursor:pointer}button.secondary{background:#2b2f37}button:disabled{opacity:.6;cursor:not-allowed}input[type=number]{width:120px;padding:6px;border-radius:6px;border:1px solid #2b2f37;background:#0e0f12;color:#eee}.panel{background:#141820;border-bottom:1px solid #2b2f37;padding:12px 16px}.panel.hidden{display:none}.timer{padding:16px}.house-wrapper{display:flex;justify-content:center;align-items:center;padding:12px}.house{position:relative;width:min(960px,96vw);height:540px;background:#0c0e12 url('img/house-bg-detailed.svg') center/cover no-repeat;border:1px solid #2b2f37;border-radius:12px;box-shadow:0 0 0 1px #000 inset}#houseSlots{position:absolute;inset:0}.slot{position:absolute;border:2px dashed #6366f1;border-radius:10px;min-width:100px;min-height:80px;display:flex;flex-direction:column;justify-content:center;align-items:center;background:rgba(21,24,33,0.7)}.slot.empty{border:2px dashed #3d4451;filter:grayscale(0.4) opacity(0.8)}.slot.filled{border:2px solid #4b5563;background:rgba(40,48,60,0.55);box-shadow:0 4px 12px -2px rgba(0,0,0,0.7), inset 0 0 4px rgba(255,255,255,0.05)}.slot.filled img{filter:drop-shadow(0 4px 6px rgba(0,0,0,0.6))}.slot img{max-width:100%;max-height:100%;object-fit:contain}.slot .slot-name{position:absolute;top:-18px;left:0;font-size:12px;opacity:.8}
/* Posiciones de slots */ .slot[data-slot="sofa"]{left:140px;bottom:40px;width:220px;height:120px}.slot[data-slot="mesa"]{left:420px;bottom:52px;width:140px;height:90px}.slot[data-slot="lampara"]{left:60px;bottom:70px;width:80px;height:140px}.slot[data-slot="cuadro"]{left:260px;top:60px;width:160px;height:90px}.slot[data-slot="cocina_mueble"]{left:20px;top:180px;width:240px;height:90px}.slot[data-slot="cocina_frigorifico"]{left:20px;top:70px;width:80px;height:150px}.slot[data-slot="cocina_horno"]{left:270px;top:190px;width:90px;height:70px}.slot[data-slot="planta_suelo"]{right:40px;bottom:50px;width:80px;height:140px}.slot[data-slot="planta_colgante"]{right:60px;top:35px;width:90px;height:90px}.slot[data-slot="alfombra"]{left:160px;bottom:25px;width:300px;height:80px}.slot[data-slot="estanteria"]{right:40px;top:80px;width:120px;height:140px}.grid{display:grid;gap:12px;grid-template-columns:repeat(auto-fill,minmax(180px,1fr))}.card{border:1px solid #2b2f37;border-radius:8px;padding:8px;background:#151821}.card img{width:100%;height:110px;object-fit:contain;background:#0e0f12;border-radius:6px}.meta{display:flex;justify-content:space-between;align-items:center;margin-top:8px}
/* Dialog */ dialog{border:none;border-radius:8px;padding:0;width:min(420px,90vw)}dialog form{padding:16px;background:#1a1d23;color:#eee}dialog img{width:100%;height:220px;object-fit:contain;background:#111;border-radius:6px}dialog menu{display:flex;justify-content:flex-end;gap:8px;margin-top:12px}dialog#claimDialog h2{margin-top:0}dialog#claimDialog .claim-form p{font-size:18px;margin:8px 0}.controls{display:flex;gap:8px;align-items:center}.controls select{padding:6px;border-radius:6px;border:1px solid #2b2f37;background:#0e0f12;color:#eee}.cat{border:1px solid #2b2f37;border-radius:8px;margin-bottom:10px;background:#0f1218}.cat>summary{cursor:pointer;padding:8px 12px;font-weight:600}.cat-items{padding:8px 12px}.filters{display:flex;flex-wrap:wrap;gap:8px;margin:8px 0}.filters button{background:#2b2f37;padding:6px 10px;border-radius:6px;font-size:13px}.filters button.active{background:#3a6df0}.cat-items.row{display:flex;flex-wrap:wrap;gap:10px;align-items:flex-start}.cat-items.row .card{min-width:120px;flex:0 1 140px}.cat>summary{display:flex;align-items:center;justify-content:space-between}.cat.expanded{width:100%;display:block}.cat.expanded>summary{border-bottom:1px solid #2b2f37;margin-bottom:8px}

/* ----------------- Mobile-first / responsive tweaks ----------------- */
/* Hacer el header más compacto y táctil */
header{padding:10px 14px}header h1{font-size:18px}
.top-actions{gap:8px}

/* Temporizador: destacar en móvil */
.timer{display:flex;flex-direction:column;gap:12px;align-items:center;padding:16px}
#status{font-size:14px;opacity:0.95}
.timer-display{font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;font-weight:700;font-size:46px;line-height:1;color:#fff;background:linear-gradient(180deg,#2b6df0,#3a6df0);padding:12px 18px;border-radius:12px;box-shadow:0 6px 18px rgba(58,109,240,0.25);min-width:140px;text-align:center}
.controls{flex-wrap:wrap;justify-content:center}
.controls input[type=number]{width:90px}
#startBtn,#cancelBtn{padding:12px 16px;border-radius:10px;font-size:16px}

/* House: ajustar escala en móviles, añadir profundidad y sombra para mayor realismo */
.house{width:100%;max-width:760px;height:360px;border-radius:14px;background-position:center;background-size:cover;overflow:hidden;transform-style:preserve-3d;box-shadow: 0 8px 30px rgba(0,0,0,0.7), inset 0 -20px 60px rgba(0,0,0,0.35)}
.house::before{content:'';position:absolute;left:0;right:0;top:0;height:40%;background:linear-gradient(180deg,rgba(0,0,0,0.18),rgba(0,0,0,0));pointer-events:none}
.slot{transition:transform .18s ease, box-shadow .18s ease}
.slot:hover{transform:translateY(-4px);box-shadow:0 10px 30px rgba(0,0,0,0.5)}
.slot .slot-name{background:rgba(0,0,0,0.45);padding:4px 8px;border-radius:6px;font-size:12px}

/* Catalog panel: en móvil se abre como modal desde abajo, ocupa gran parte de la pantalla */
#catalogPanel{position:relative;transition:transform .28s ease}
@media (max-width:600px){
  #catalogPanel{position:fixed;left:0;right:0;bottom:0;height:64vh;background:linear-gradient(180deg,#121318,#0e1114);border-top-left-radius:12px;border-top-right-radius:12px;padding:14px 16px;box-shadow:0 -8px 30px rgba(0,0,0,0.6);z-index:60;overflow:auto}
  #catalogPanel.hidden{transform:translateY(100%)}
  #catalogPanel:not(.hidden){transform:translateY(0)}
  /* Barra de navegación móvil */
  footer#mobileNav{position:fixed;left:8px;right:8px;bottom:8px;height:58px;background:linear-gradient(180deg,#1b1f26,#14161a);border-radius:12px;display:flex;align-items:center;justify-content:space-around;z-index:70;padding:6px;box-shadow:0 8px 20px rgba(0,0,0,0.6)}
  footer#mobileNav button{flex:1;margin:0 6px;padding:10px;border-radius:10px;font-size:15px}
  .cat-items.row{gap:10px}
  .cat-items.row .card{min-width:160px}
  .card img{height:120px}
  /* Ajustes en la casa para pantallas pequeñas */
  .house{height:300px}
  .slot[data-slot="sofa"]{left:10%;bottom:10%;width:48%;height:30%}
  .slot[data-slot="mesa"]{left:55%;bottom:12%;width:18%;height:18%}
  .slot[data-slot="lampara"]{left:2.5%;bottom:12%;width:12%;height:28%}
  .slot[data-slot="cuadro"]{left:28%;top:6%;width:30%;height:14%}
  .slot[data-slot="cocina_mueble"]{left:2%;top:36%;width:48%;height:20%}
  .slot[data-slot="cocina_frigorifico"]{left:2%;top:14%;width:10%;height:34%}
  .slot[data-slot="cocina_horno"]{left:56%;top:38%;width:12%;height:12%}
  .slot[data-slot="planta_suelo"]{right:6%;bottom:14%;width:12%;height:28%}
  .slot[data-slot="planta_colgante"]{right:8%;top:6%;width:14%;height:16%}
  .slot[data-slot="alfombra"]{left:18%;bottom:6%;width:64%;height:18%}
  .slot[data-slot="estanteria"]{right:6%;top:18%;width:18%;height:34%}
}

/* Mejores targets táctiles en general */
button, .filters button, .card button{touch-action:manipulation}

/* Aumentar legibilidad en pantallas pequeñas */
@media (max-width:380px){
  .timer-display{font-size:36px;padding:10px;min-width:120px}
  header h1{font-size:16px}
  .controls input[type=number]{width:70px}
}

/* Estilos para vista 'tienda' dentro del panel del catálogo */
#catalogPanel .catalog-page{display:block}
#catalogPanel .catalog-categories{display:flex;flex-wrap:wrap;gap:10px;justify-content:flex-start;padding:8px 0}
#catalogPanel .catalog-categories button{padding:10px 12px;border-radius:8px;background:#1b1f26;border:1px solid #2b2f37;color:#fff;cursor:pointer}
#catalogPanel .catalog-page .store-grid{display:grid;gap:18px;padding:6px;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));width:100%}
#catalogPanel .store-grid .card{display:flex;flex-direction:column;gap:8px;padding:8px}

/* Alineación y presentación de los filtros (fila superior) */
#catalogFilters{display:flex;gap:10px;flex-wrap:wrap;align-items:center;padding:8px 0}
#catalogFilters button{padding:8px 10px;border-radius:8px;background:#2b2f37;border:1px solid #2b2f37;color:#fff}
#catalogFilters button.active{background:#3a6df0;border-color:#3a6df0}

/* Evitar que aparezca una 'columna lateral' por margen negativo/anchos fijos */
#catalogGrid{padding:0 6px}
#catalogGrid .catalog-page{max-width:1200px;margin:0 auto}

/* Responsive: en pantallas pequeñas, el panel ocupa todo y la grid es única columna */
@media (max-width:600px){
  #catalogPanel{padding:14px 16px}
  #catalogGrid .store-grid{grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px}
  /* ocultar cualquier sidebar lateral si existiera por legacy */
  #catalogPanel .sidebar, #catalogPanel .side-list{display:none!important}
}

/* Responsive: mejor separación en pantallas grandes */
@media (min-width:900px){
  #catalogGrid .catalog-page{padding:8px 24px}
}

/* ----------------- Ocultar recuadros de slots en la casa ----------------- */
/* Por defecto no mostrar los marcos, fondos ni nombres de los slots para que
   la casa se vea limpia. Si se necesita volver a verlos, añadir la clase
   `show-slots` al elemento `.house` (por ejemplo: document.querySelector('.house').classList.add('show-slots')). */
.house .slot{
  border: none;
  background: transparent;
  box-shadow: none;
  /* permitimos transformaciones y transiciones para los efectos 3D */
  transition: transform .18s ease, box-shadow .18s ease;
}
.house .slot .slot-name{display:none}

/* Clase utilitaria para restaurar la visualización de los slots (uso opcional) */
.house.show-slots .slot{border:2px dashed #6366f1;background:rgba(21,24,33,0.7);box-shadow:0 4px 12px -2px rgba(0,0,0,0.7), inset 0 0 4px rgba(255,255,255,0.05);transition:transform .18s ease, box-shadow .18s ease}
.house.show-slots .slot .slot-name{display:block}

/* ================== Nuevos estilos 3D y de interacción ================== */
.house-wrapper{perspective:1100px}
.house{transform-style:preserve-3d;transition:transform .25s cubic-bezier(.2,.9,.3,1);will-change:transform}

/* profundidad por defecto (puedes ajustar por slot) */
.slot{transform: translateZ(var(--z,0px));}

/* Depth hints: asignar valor --z por slot para que se vean estratificados */
.slot[data-slot="sofa"]{ --z: 36px }
.slot[data-slot="mesa"]{ --z: 28px }
.slot[data-slot="lampara"]{ --z: 42px }
.slot[data-slot="cuadro"]{ --z: 18px }
.slot[data-slot="cocina_mueble"]{ --z: 20px }
.slot[data-slot="cocina_frigorifico"]{ --z: 24px }
.slot[data-slot="cocina_horno"]{ --z: 16px }
.slot[data-slot="planta_suelo"]{ --z: 30px }
.slot[data-slot="planta_colgante"]{ --z: 40px }
.slot[data-slot="alfombra"]{ --z: 8px }
.slot[data-slot="estanteria"]{ --z: 26px }

/* Efecto al resaltar (dragenter) */
.slot.highlight{ box-shadow: 0 18px 40px rgba(0,0,0,0.6); transform: translateZ(calc(var(--z,0px) + 24px)) scale(1.02); z-index:60 }
.slot.highlight .slot-name{ display:block }

/* Imagen dentro del slot: profundidad y sombreado realista */
.slot img{ transform: translateZ(8px); transition: transform .25s ease, filter .2s ease; display:block; max-width:100%; max-height:100%; }
.slot.filled img{ filter: drop-shadow(0 18px 30px rgba(0,0,0,0.65)); }

/* Indicar visualmente cuando se está arrastrando desde el catálogo */
.drag-source{ opacity:0.7; transform: scale(.98); }

/* cursor y overlay de drop */
.slot::after{ content:''; position:absolute; inset:0; pointer-events:none; border-radius:8px; transition:opacity .15s ease; }
.slot.highlight::after{ background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.2)); opacity:1 }

/* Pequeña etiqueta de ayuda sobre slots (aparece al hacer hover en escritorio) */
.slot:hover .slot-name{ display:block; position:absolute; top:-22px; left:0; background:rgba(0,0,0,0.55); padding:4px 8px; border-radius:6px; font-size:12px }

/* Estilos para la imagen durante el drag (fuera del slot) */
html.dragging-img{ cursor:grabbing }

/* Mejorar visibilidad en modo 3D activado */
.house.show-3d{ box-shadow: 0 16px 60px rgba(0,0,0,0.65), inset 0 -20px 60px rgba(0,0,0,0.35) }
